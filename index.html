<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="CW-Dilettant - Lerne Morsen/Telegrafie">
    <meta name="theme-color" content="#1976D2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CW-Dilettant">

    <title>CW-Dilettant</title>

    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- App Container -->
    <div id="app" class="app">

        <!-- App Bar -->
        <header class="app-bar">
            <button class="icon-button" id="menuBtn" aria-label="Menü öffnen">
                <span class="material-icons">menu</span>
            </button>
            <h1 class="app-bar-title">CW-Dilettant</h1>
        </header>

        <!-- Navigation Drawer (Hamburger Menu) -->
        <aside class="nav-drawer" id="navDrawer">
            <div class="nav-drawer-header">
                <span class="nav-drawer-title">CW-Dilettant</span>
                <span class="nav-drawer-subtitle">Morse lernen</span>
            </div>
            <nav class="nav-drawer-content">
                <ul class="nav-list">
                    <li>
                        <a href="#home" class="nav-item active" data-page="home">
                            <span class="material-icons">home</span>
                            <span>Start</span>
                        </a>
                    </li>
                    <li>
                        <a href="#hoeren" class="nav-item" data-page="hoeren">
                            <span class="material-icons">headphones</span>
                            <span>Hören</span>
                        </a>
                    </li>
                    <li>
                        <a href="#erkennen" class="nav-item" data-page="erkennen">
                            <span class="material-icons">quiz</span>
                            <span>Erkennen</span>
                        </a>
                    </li>
                    <li>
                        <a href="#geben" class="nav-item" data-page="geben">
                            <span class="material-icons">keyboard</span>
                            <span>Geben</span>
                        </a>
                    </li>
                </ul>
                <div class="nav-divider"></div>
                <ul class="nav-list">
                    <li>
                        <a href="#einstellungen" class="nav-item" data-page="einstellungen">
                            <span class="material-icons">settings</span>
                            <span>Einstellungen</span>
                        </a>
                    </li>
                    <li>
                        <a href="#ueber" class="nav-item" data-page="ueber">
                            <span class="material-icons">info</span>
                            <span>Über</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Overlay for drawer -->
        <div class="nav-overlay" id="navOverlay"></div>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">

            <!-- Home Page -->
            <section class="page active" id="page-home">
                <div class="page-content">
                    <!-- Statistik Card -->
                    <div class="card stats-card">
                        <div class="card-header">
                            <span class="material-icons">bar_chart</span>
                            <h2>Statistik</h2>
                        </div>
                        <div class="card-content">
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <span class="stat-value" id="statSessions">0</span>
                                    <span class="stat-label">Übungen</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-value" id="statCorrect">0%</span>
                                    <span class="stat-label">Richtig</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-value" id="statChars">0</span>
                                    <span class="stat-label">Zeichen</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-value" id="statTime">0h</span>
                                    <span class="stat-label">Übungszeit</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <h3 class="section-title">Übungen</h3>
                    <div class="action-buttons">
                        <button class="action-card" data-navigate="hoeren">
                            <span class="material-icons">headphones</span>
                            <span class="action-title">Hören</span>
                            <span class="action-desc">Morse-Zeichen hören und lernen</span>
                        </button>
                        <button class="action-card" data-navigate="erkennen">
                            <span class="material-icons">quiz</span>
                            <span class="action-title">Erkennen</span>
                            <span class="action-desc">Gehörtes identifizieren</span>
                        </button>
                        <button class="action-card" data-navigate="geben">
                            <span class="material-icons">keyboard</span>
                            <span class="action-title">Geben</span>
                            <span class="action-desc">Selbst morsen üben</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Hören Page -->
            <section class="page" id="page-hoeren">
                <div class="page-content">
                    <!-- Lektionsnavigation -->
                    <div class="lesson-nav">
                        <button class="lesson-nav-btn" id="prevLesson" aria-label="Vorherige Lektion">
                            <span class="material-icons">chevron_left</span>
                        </button>
                        <div class="lesson-info">
                            <span class="lesson-number" id="lessonNumber">Lektion 1</span>
                            <span class="lesson-chars" id="lessonChars">K, M</span>
                        </div>
                        <button class="lesson-nav-btn" id="nextLesson" aria-label="Nächste Lektion">
                            <span class="material-icons">chevron_right</span>
                        </button>
                    </div>

                    <!-- Aktuelles Zeichen Display -->
                    <div class="char-display" id="charDisplay">
                        <div class="char-letter" id="charLetter">-</div>
                        <div class="char-morse" id="charMorse"></div>
                        <div class="char-phonetic" id="charPhonetic"></div>
                    </div>

                    <!-- Phase & Progress -->
                    <div class="phase-info">
                        <span class="phase-label" id="phaseLabel">Bereit</span>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <span class="progress-text" id="progressText"></span>
                    </div>

                    <!-- Gruppen-Anzeige -->
                    <div class="group-display" id="groupDisplay">
                        <div class="group-chars" id="groupChars"></div>
                    </div>

                    <!-- Steuerung -->
                    <div class="controls">
                        <button class="btn btn-primary btn-large" id="btnStart">
                            <span class="material-icons">play_arrow</span>
                            <span>Start</span>
                        </button>
                        <button class="btn btn-secondary btn-large" id="btnStop" disabled>
                            <span class="material-icons">stop</span>
                            <span>Stop</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Erkennen Page -->
            <section class="page" id="page-erkennen">
                <div class="page-content">
                    <!-- Modus-Auswahl -->
                    <div class="mode-selector">
                        <button class="mode-btn active" id="erkModeKeyboard" data-mode="keyboard">
                            <span class="material-icons">keyboard</span>
                            <span>Tastatur</span>
                        </button>
                        <button class="mode-btn" id="erkModePaper" data-mode="paper">
                            <span class="material-icons">edit_note</span>
                            <span>Papier</span>
                        </button>
                    </div>

                    <!-- Lektionsnavigation -->
                    <div class="lesson-nav">
                        <button class="lesson-nav-btn" id="erkPrevLesson" aria-label="Vorherige Lektion">
                            <span class="material-icons">chevron_left</span>
                        </button>
                        <div class="lesson-info">
                            <span class="lesson-number" id="erkLessonNumber">Lektion 1</span>
                            <span class="lesson-chars" id="erkLessonChars">K, M</span>
                        </div>
                        <button class="lesson-nav-btn" id="erkNextLesson" aria-label="Nächste Lektion">
                            <span class="material-icons">chevron_right</span>
                        </button>
                    </div>

                    <!-- Phase & Progress -->
                    <div class="phase-info">
                        <span class="phase-label" id="erkPhaseLabel">Bereit</span>
                        <div class="progress-bar">
                            <div class="progress-fill" id="erkProgressFill"></div>
                        </div>
                        <span class="progress-text" id="erkProgressText"></span>
                    </div>

                    <!-- Tastatur-Modus: Eingabefeld -->
                    <div class="erk-keyboard-view" id="erkKeyboardView">
                        <div class="erk-input-container">
                            <input type="text"
                                   class="erk-input"
                                   id="erkInput"
                                   placeholder="Gehörtes eingeben..."
                                   autocomplete="off"
                                   autocapitalize="characters"
                                   spellcheck="false">
                            <div class="input-feedback" id="erkInputFeedback"></div>
                        </div>
                    </div>

                    <!-- Papier-Modus: Lösung & Fehler -->
                    <div class="erk-paper-view hidden" id="erkPaperView">
                        <!-- Lösung anzeigen -->
                        <div class="solution-card" id="erkSolutionCard">
                            <div class="solution-header">
                                <h3>Lösung</h3>
                                <button class="btn btn-icon-small" id="erkSpeakSolution" title="Lösung ansagen">
                                    <span class="material-icons">volume_up</span>
                                </button>
                            </div>
                            <div class="solution-list" id="erkSolutionList"></div>
                        </div>

                        <!-- Fehler eingeben -->
                        <div class="error-card" id="erkErrorCard">
                            <h3>Auswertung</h3>
                            <p class="error-hint">Vergleiche mit deinen Notizen und zähle die Fehler:</p>
                            <div class="error-input-row">
                                <button class="btn btn-icon" id="erkErrorMinus">
                                    <span class="material-icons">remove</span>
                                </button>
                                <div class="error-display">
                                    <span class="error-count" id="erkErrorCount">0</span>
                                    <span class="error-label">Fehler</span>
                                </div>
                                <button class="btn btn-icon" id="erkErrorPlus">
                                    <span class="material-icons">add</span>
                                </button>
                            </div>
                            <div class="error-stats" id="erkErrorStats"></div>
                            <button class="btn btn-primary btn-wide" id="erkSaveErrors">
                                <span class="material-icons">check</span>
                                <span>Auswertung speichern</span>
                            </button>
                        </div>

                        <!-- Ergebnis -->
                        <div class="result-card hidden" id="erkResultCard">
                            <div class="result-icon">
                                <span class="material-icons" id="erkResultIcon">emoji_events</span>
                            </div>
                            <div class="result-percent" id="erkResultPercent">0%</div>
                            <div class="result-text" id="erkResultText">richtig</div>
                            <button class="btn btn-primary" id="erkNewRound">
                                <span class="material-icons">replay</span>
                                <span>Neue Runde</span>
                            </button>
                        </div>
                    </div>

                    <!-- Steuerung -->
                    <div class="controls">
                        <button class="btn btn-primary btn-large" id="erkBtnStart">
                            <span class="material-icons">play_arrow</span>
                            <span>Start</span>
                        </button>
                        <button class="btn btn-secondary btn-large" id="erkBtnStop" disabled>
                            <span class="material-icons">stop</span>
                            <span>Stop</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Geben Page -->
            <section class="page" id="page-geben">
                <div class="page-content">
                    <!-- Anleitung -->
                    <div class="card geben-info">
                        <div class="card-content">
                            <p><strong>Leertaste</strong> = Morsetaste</p>
                            <p>Kurz drücken = Dit (.) &nbsp;|&nbsp; Lang drücken = Dah (-)</p>
                        </div>
                    </div>

                    <!-- Ton-Toggle -->
                    <div class="geben-tone-toggle">
                        <button class="btn btn-icon-toggle active" id="gebenToneToggle" title="Ton ein/aus">
                            <span class="material-icons">volume_up</span>
                        </button>
                    </div>

                    <!-- Aktuelle Eingabe -->
                    <div class="geben-display">
                        <div class="geben-sequence" id="gebenSequence"></div>
                        <div class="geben-char" id="gebenChar">-</div>
                    </div>

                    <!-- Eingegebener Text -->
                    <div class="geben-output">
                        <div class="geben-output-label">Eingegebener Text:</div>
                        <div class="geben-output-text" id="gebenOutput"></div>
                        <button class="btn btn-outline" id="gebenClear">
                            <span class="material-icons">backspace</span>
                            <span>Löschen</span>
                        </button>
                    </div>

                    <!-- Steuerung -->
                    <div class="controls">
                        <button class="btn btn-primary btn-large" id="gebenBtnStart">
                            <span class="material-icons">play_arrow</span>
                            <span>Start</span>
                        </button>
                        <button class="btn btn-secondary btn-large" id="gebenBtnStop" disabled>
                            <span class="material-icons">stop</span>
                            <span>Stop</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Einstellungen Page -->
            <section class="page" id="page-einstellungen">
                <div class="page-content">
                    <!-- Tabs -->
                    <div class="tabs">
                        <button class="tab active" data-tab="tab-allgemein">Allgemein</button>
                        <button class="tab" data-tab="tab-cw">CW</button>
                        <button class="tab" data-tab="tab-hoeren">Hören</button>
                        <button class="tab" data-tab="tab-erkennen">Erkennen</button>
                        <button class="tab" data-tab="tab-aussprache">Sprache</button>
                    </div>

                    <!-- Tab: Allgemein -->
                    <div class="tab-content active" id="tab-allgemein">
                        <div class="settings-group">
                            <h3 class="settings-title">Erscheinungsbild</h3>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <span class="setting-label">Dunkles Design</span>
                                    <span class="setting-desc">Aktiviert das dunkle Farbschema</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="settingDarkMode">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: CW-Parameter -->
                    <div class="tab-content" id="tab-cw">
                        <div class="settings-group">
                            <h3 class="settings-title">Geschwindigkeit</h3>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Geschwindigkeit (WPM)</span>
                                    <span class="setting-value" id="wpmValue">20</span>
                                </div>
                                <input type="range" class="slider-range" id="settingWpm" min="5" max="40" value="20">
                            </div>
                        </div>

                        <div class="settings-group">
                            <h3 class="settings-title">Ton</h3>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Tonhöhe (Hz)</span>
                                    <span class="setting-value" id="freqValue">600</span>
                                </div>
                                <input type="range" class="slider-range" id="settingFreq" min="400" max="1000" step="50" value="600">
                            </div>
                        </div>

                        <div class="settings-group">
                            <h3 class="settings-title">Zeichensatz</h3>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <span class="setting-label">Buchstaben</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="settingLetters" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <span class="setting-label">Zahlen</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="settingNumbers" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <span class="setting-label">Sonderzeichen</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="settingSpecial">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Hören -->
                    <div class="tab-content" id="tab-hoeren">
                        <div class="settings-group">
                            <h3 class="settings-title">Wiederholungen</h3>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Mit Pause</span>
                                    <span class="setting-value" id="repsWithPauseValue">3</span>
                                </div>
                                <input type="range" class="slider-range" id="settingRepsWithPause" min="1" max="10" value="3">
                            </div>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Ohne Pause</span>
                                    <span class="setting-value" id="repsNoPauseValue">3</span>
                                </div>
                                <input type="range" class="slider-range" id="settingRepsNoPause" min="1" max="10" value="3">
                            </div>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Pause zwischen Wdh. (ms)</span>
                                    <span class="setting-value" id="pauseBetweenValue">800</span>
                                </div>
                                <input type="range" class="slider-range" id="settingPauseBetween" min="300" max="2000" step="100" value="800">
                            </div>
                        </div>

                        <div class="settings-group">
                            <h3 class="settings-title">Übungsgruppen</h3>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Gruppengröße</span>
                                    <span class="setting-value" id="groupSizeValue">5</span>
                                </div>
                                <input type="range" class="slider-range" id="settingGroupSize" min="3" max="7" value="5">
                            </div>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Anzahl Gruppen</span>
                                    <span class="setting-value" id="numGroupsValue">10</span>
                                </div>
                                <input type="range" class="slider-range" id="settingNumGroups" min="5" max="50" step="5" value="10">
                            </div>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Pause nach Gruppe (s)</span>
                                    <span class="setting-value" id="pauseAfterGroupValue">2.5</span>
                                </div>
                                <input type="range" class="slider-range" id="settingPauseAfterGroup" min="1000" max="10000" step="500" value="2500">
                            </div>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Gewichtung neues Zeichen (%)</span>
                                    <span class="setting-value" id="newCharWeightValue">40</span>
                                </div>
                                <input type="range" class="slider-range" id="settingNewCharWeight" min="20" max="60" step="5" value="40">
                            </div>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Wiederholung letzte Lektionen</span>
                                    <span class="setting-value" id="reviewLessonsValue">5</span>
                                </div>
                                <input type="range" class="slider-range" id="settingReviewLessons" min="3" max="10" value="5">
                            </div>
                        </div>

                        <div class="settings-group">
                            <h3 class="settings-title">Modus</h3>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <span class="setting-label">Endlos-Modus</span>
                                    <span class="setting-desc">Lektion wiederholt sich automatisch</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="settingEndless">
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <span class="setting-label">Gruppen ansagen</span>
                                    <span class="setting-desc">"Gruppe 1", "Gruppe 2", ...</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="settingAnnounceGroups">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Erkennen -->
                    <div class="tab-content" id="tab-erkennen">
                        <div class="settings-group">
                            <h3 class="settings-title">Übungsgruppen</h3>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Gruppengröße</span>
                                    <span class="setting-value" id="erkGroupSizeValue">5</span>
                                </div>
                                <input type="range" class="slider-range" id="settingErkGroupSize" min="3" max="7" value="5">
                            </div>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Anzahl Gruppen</span>
                                    <span class="setting-value" id="erkNumGroupsValue">10</span>
                                </div>
                                <input type="range" class="slider-range" id="settingErkNumGroups" min="5" max="20" value="10">
                            </div>

                            <div class="setting-item vertical">
                                <div class="setting-info">
                                    <span class="setting-label">Pause nach Gruppe (s)</span>
                                    <span class="setting-value" id="erkPauseAfterGroupValue">2.5</span>
                                </div>
                                <input type="range" class="slider-range" id="settingErkPauseAfterGroup" min="1000" max="10000" step="500" value="2500">
                            </div>
                        </div>

                        <div class="settings-group">
                            <h3 class="settings-title">Tastatur-Modus</h3>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <span class="setting-label">Sofort-Feedback</span>
                                    <span class="setting-desc">Zeigt Ergebnis nach jeder Gruppe</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="settingErkInstantFeedback" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Aussprache -->
                    <div class="tab-content" id="tab-aussprache">
                        <div class="settings-group">
                            <h3 class="settings-title">Buchstabier-Alphabet</h3>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <span class="setting-label">Sprache für Ansage</span>
                                    <span class="setting-desc">Buchstabiertafel für gesprochene Zeichen</span>
                                </div>
                                <select class="select" id="settingPhoneticLang">
                                    <option value="en">Englisch (NATO)</option>
                                    <option value="de">Deutsch</option>
                                </select>
                            </div>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <span class="setting-label">Zeichen ansagen</span>
                                    <span class="setting-desc">Zeichen vor dem Morse-Ton aussprechen</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="settingAnnounce" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Über Page -->
            <section class="page" id="page-ueber">
                <div class="page-content">
                    <div class="about-content">
                        <div class="about-header">
                            <img src="icons/icon-128.png" alt="CW-Dilettant Logo" class="about-logo">
                            <h2>CW-Dilettant</h2>
                            <p class="version">Version 1.0.0</p>
                        </div>

                        <div class="card">
                            <div class="card-content">
                                <h3>Autor</h3>
                                <p><strong>Chris Seifert</strong> (DL6LG)</p>
                                <p>
                                    <a href="mailto:info@cseifert.de" class="link">
                                        <span class="material-icons">email</span>
                                        info@cseifert.de
                                    </a>
                                </p>
                                <p>
                                    <a href="https://www.ohrenbeisser.de" target="_blank" rel="noopener" class="link">
                                        <span class="material-icons">language</span>
                                        www.ohrenbeisser.de
                                    </a>
                                </p>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-content">
                                <h3>Lizenz & Quellcode</h3>
                                <p>Diese App ist Open Source unter der <strong>MIT-Lizenz</strong>.</p>
                                <p>
                                    <a href="https://github.com/ohrenbeisser" target="_blank" rel="noopener" class="link">
                                        <span class="material-icons">code</span>
                                        github.com/ohrenbeisser
                                    </a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Scripts -->
    <script src="js/storage.js"></script>
    <script src="js/phonetic.js"></script>
    <script src="js/morse.js"></script>
    <script src="js/speaker.js"></script>
    <script src="js/koch.js"></script>
    <script src="js/erkennen.js"></script>
    <script src="js/geben.js"></script>
    <script src="js/router.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
